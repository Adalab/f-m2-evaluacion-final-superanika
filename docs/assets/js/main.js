"use strict";const button=document.querySelector(".button"),results=document.querySelector(".results"),favSeriesList=document.querySelector(".fav__series"),favDiv=document.querySelector(".fav__list"),main=document.querySelector(".main"),noResults=document.querySelector(".no__results");function getSeries(){const e=document.querySelector(".input").value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{noResults.innerHTML="",0===e.length?errorMsg():createList(e)})}function errorMsg(){const e=document.createElement("p"),t=document.createTextNode("La bÃºsqueda realizada no ha obtenido resultados");e.classList.add("error"),e.appendChild(t),noResults.appendChild(e),main.appendChild(noResults)}function createList(e){for(const t of e){const e=t.show,s=e.name,a=e.image,n=document.createElement("li");n.classList.add("list__item"),n.addEventListener("click",addFavorite),results.appendChild(n);const i=document.createElement("h2");i.classList.add("serie__title");const r=document.createTextNode(s);i.appendChild(r),n.appendChild(i);const c=document.createElement("img");c.classList.add("serie_img"),c.src=null===a?"https://via.placeholder.com/210x295/ffffff/6666ff/?text=TV":a.medium,n.appendChild(c)}}function createFavs(e){const t=document.createElement("li");t.classList.add("fav__list-item");const s=document.createElement("i");s.classList.add("fas"),s.classList.add("fa-times-circle");const a=document.createElement("h3");a.classList.add("fav__series-title");const n=document.createTextNode(e.title),i=document.createElement("img");i.classList.add("fav_img"),i.src=e.image,a.appendChild(n),t.appendChild(s),t.appendChild(a),t.appendChild(i),favSeriesList.appendChild(t)}function showSavedFavorites(){const e=JSON.parse(localStorage.getItem("savedFav"));if(null!==e&&e.length>0){favDiv.classList.remove("hidden");for(const t of e)createFavs(t)}else favDiv.classList.add("hidden")}function addFavorite(e){e.currentTarget.classList.add("fav");let t={title:"",image:""};t.title=e.currentTarget.firstChild.innerHTML,t.image=e.currentTarget.lastChild.src;let s=JSON.parse(localStorage.getItem("savedFav"));null===s&&(s=[]),alreadyExist(s,t)||(s.push(t),localStorage.setItem("savedFav",JSON.stringify(s)),createFavs(t))}function alreadyExist(e,t){for(const s of e)if(s.title===t.title)return!0;return!1}function searchSeries(){results.innerHTML="",getSeries()}button.addEventListener("click",searchSeries),showSavedFavorites();