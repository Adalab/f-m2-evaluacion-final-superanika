"use strict";const button=document.querySelector(".button"),results=document.querySelector(".results"),favSeriesList=document.querySelector(".fav__series"),favDiv=document.querySelector(".fav__list"),main=document.querySelector(".main"),noResults=document.querySelector(".no__results");function getSeries(){const e=document.querySelector(".input").value;fetch("http://api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{noResults.innerHTML="",0===e.length?errorMsg():createList(e)})}function errorMsg(){const e=document.createElement("p"),t=document.createTextNode("La bÃºsqueda realizada no ha obtenido resultados");e.classList.add("error"),e.appendChild(t),noResults.appendChild(e),main.appendChild(noResults)}function createList(e){for(const t of e){const e=t.show,s=e.name,a=e.image,i=document.createElement("li");i.classList.add("list__item"),i.addEventListener("click",addFavorite),results.appendChild(i);const n=document.createElement("h2");n.classList.add("serie__title");const d=document.createTextNode(s);n.appendChild(d),i.appendChild(n);const c=document.createElement("img");c.classList.add("serie_img"),c.src=null===a?"https://via.placeholder.com/210x295/ffffff/6666ff/?text=TV":a.medium,i.appendChild(c)}}function createFavs(e){const t=document.createElement("li");t.classList.add("fav__list-item");const s=document.createElement("i");s.classList.add("fas"),s.classList.add("fa-times-circle"),s.classList.add("delete__icon"),s.addEventListener("click",deleteFavs);const a=document.createElement("h3");a.classList.add("fav__series-title");const i=document.createTextNode(e.title),n=document.createElement("img");n.classList.add("fav_img"),n.src=e.image,a.appendChild(i),t.appendChild(s),t.appendChild(a),t.appendChild(n),favSeriesList.appendChild(t)}function showSavedFavorites(){const e=JSON.parse(localStorage.getItem("savedFav"));if(null!==e&&e.length>0){favDiv.classList.remove("hidden");for(const t of e)createFavs(t)}}function addFavorite(e){e.currentTarget.classList.add("fav");let t={title:"",image:""};t.title=e.currentTarget.firstChild.innerHTML,t.image=e.currentTarget.lastChild.src;let s=JSON.parse(localStorage.getItem("savedFav"));if(null===s&&(s=[]),!alreadyExist(s,t)){s.push(t),localStorage.setItem("savedFav",JSON.stringify(s));const e=document.createElement("li");e.classList.add("fav__list-item");const a=document.createElement("i");a.classList.add("fas"),a.classList.add("fa-times-circle"),a.classList.add("delete__icon"),a.addEventListener("click",deleteFavs);const i=document.createElement("h3");i.classList.add("fav__series-title");const n=document.createTextNode(t.title),d=document.createElement("img");d.classList.add("fav_img"),d.src=t.image,i.appendChild(n),e.appendChild(a),e.appendChild(i),e.appendChild(d),favSeriesList.appendChild(e),favDiv.classList.remove("hidden")}}function alreadyExist(e,t){for(const s of e)if(s.title===t.title)return!0;return!1}function deleteFavs(){event.currentTarget.parentElement.classList.add("hidden")}function searchSeries(){results.innerHTML="",getSeries()}button.addEventListener("click",searchSeries),showSavedFavorites();